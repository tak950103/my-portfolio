## 自動車試験モニタリングシステム

---

### 目的
燃料電池ベンチ・バッテリベンチ・サーマルベンチなど複数ベンチ（試験設備）の計測値とエネルギーフローを可視化し、試験オペレータが一目で試験状態を把握できる表示盤を提供すること。
顧客側のホストシステムから送信されるUDPデータやCSVデータをもとにリアルタイム試験モード/デモモード双方で運用できることを目的とした。

---

### 期間
2025年10月～12月
（要件定義〜基本設計〜詳細設計〜実装〜社内テストまで）

---

### 規模・体制
- エンドユーザ：自動車計測・評価システムメーカー
- 表示盤ハードウェア：社内のハードウェア設計部門
- 開発担当
	- ソフトウェア開発：1人（顧客折衝含む）
	- 顧客側：要件定義・画面デザイン指示・通信仕様策定など複数名

---

### 担当
- 要件定義支援（要望に対して、技術的に実現可能か検証）
- システム設計（画面構成・通信仕様の整理・設定ファイル構成など）
- 開発
- 社内テスト（実機を用いた動作確認）

---

### 技術
#### 言語/フレームワーク
- C#, WPF(.NET Framework 4.8)
	- MVVMアーキテクチャ
#### 通信
- UDP：表示盤に表示するステータスや計測値を受信
#### データ/設定
- CSV / TXTファイルによるデモデータ管理
- ポート番号や閾値などの設定値の外部化（設定ファイルによる管理）

---

### 主な機能
1. 操作モード切替（設定画面）
	- Testモード：UDPデータのリアルタイム表示
	- Demoモード：CSVファイルデータの再生し、試験状態を再現
2. パターンや内容の選択機能
	- 表示するベンチ・パターンのON/OFF
	- テキスト等の表示/非表示
	- 表示するイメージ（車種）の切り替え
3. メイン表示画面
	- 各ベンチや機器のステータス表示・切り替え
	- 冷却水・電力・熱量等のアニメーションで表示・切り替え（閾値を基準）
4. アナログメータ
	- 車速やバッテリーをアナログメータで表示
5. 詳細ポップアップ表示
	- 各機器をタップすると詳細ウィンドウをポップアップ表示（車速・バッテリ・電力・温度・流量など）
	- ドラッグ移動や複数同時表示を自在に可能

---

### 工夫点
- WPFでのGIFアニメーション再生（AnimatedImage）
	- 標準のWPF`Image`ではアニメーションGIFを再生できず、1フレーム目で静止してしまうため、自作コントロールを実装
	- `GifBitmapDecoder`・`DispatcherTimer`でフレーム制御、アニメーションを同時再生しても負荷が大きくならないように設計。
	- 再生/停止、表示/非表示をViewModelから制御。状態変化とアニメーションを同期
- 1px単位のデザイン要求への対応
	- 顧客デザイン部門からFigmaベースの細かなデザイン指定があり、`Canvas`を使用して画像等の各リソースの配置を行った
	- スピードメーターはLiveChartsを複数組み合わせたカスタムゲージとして実装
	- 背景・目盛・針・閾値ゾーンを別テンプレとして構成し、デザイン仕様書にできる限り近い見た目になるよう調整
- UI先行の開発プロセス
	- 顧客のデザイン仕様書に合わせて、静的なUIレイアウトをほぼ完成させ、その後で通信ロジックを接続する方針を採用
	- これにより、初期段階で顧客と画面の見た目やレイアウトのすり合わせを行い、ロジック実装後の手戻りを最小限に抑えた。
- 閾値・ポート番号などのconfig化
	- 各数値の閾値やUDPポート番号をconfigに集約。
	- 顧客側で閾値を簡単に変更できるようにした。